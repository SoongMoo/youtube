<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
구매목록<br />
<table width="800" align = "center">
	<tr><td>주문일(결제번호)</td> <td>상품명(이미지) / 주문번호</td>	
		<td>주문상태</td>
	</tr>
	<tr th:each=" orderListDTO : ${list}" >
		<td>[[${#dates.format(orderListDTO.purchaseDTO.purchaseDate,'yyyy-MM-dd')}]](
			<!-- 결제 시간이 없다는 건 아직 결제가 안되었다는 의미입니다. -->
			<th:block th:if="${orderListDTO.paymentDTO.appltime == null}">
				결제대기중
			</th:block>
			<!-- 결제 시간이 있다는 건 결제가 이루어졌다는 의미입니다. -->
			<th:block th:if="${orderListDTO.paymentDTO.appltime != null}">
				<!-- 현금결제인 경우 승인번호가 없을 수 있습니다. -->
				<th:block th:if="${orderListDTO.paymentDTO.confirmnumber == null}">
					<!-- 결제시간은 있는데 승인번호가 없다는 건 --> 현금결제 
				</th:block>
				<th:block th:if="${orderListDTO.paymentDTO.confirmnumber != null}">
				[[${orderListDTO.paymentDTO.confirmnumber}]]<!-- 승인번호 -->
				</th:block>
			</th:block>
			)</td> 
		<!-- 결제정보 하나에 상품은 여러개 일 수 있어 collection으로 받아 욌습니다. -->
		<td>
			<th:block th:each="dto : ${orderListDTO.purchaseListGoodsDTOs}" >
			<img th:src="|/static/upload/${dto.goods.goodsMainStore}|" width="30" />
			([[${dto.goods.goodsName}]])
			</th:block>
		/ [[${orderListDTO.purchaseDTO.purchaseNum}]]</td>	
		<td>
			<th:block th:if="${orderListDTO.paymentDTO.appltime != null}">
			<a th:href="|paymentDel?purchaseNum=${orderListDTO.purchaseDTO.purchaseNum}|">결제취소</a> 
			</th:block>
			<th:block th:if="${orderListDTO.paymentDTO.appltime == null}">
				<!-- 이미 만들어져 있어서 경로만 잡아주면 됩니다. -->
			<a th:href="|paymentOk?purchaseNum=${orderListDTO.purchaseDTO.purchaseNum}|">결제하기</a>
			</th:block>
		</td>
	</tr>
</table>
</body>
</html>